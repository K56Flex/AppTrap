<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AppTrap: AppTrapPreferencePane/Sparkle.framework/Versions/A/Headers/SUUpdater.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">AppTrap&#160;<span id="projectnumber">1.1.6</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">AppTrapPreferencePane/Sparkle.framework/Versions/A/Headers/SUUpdater.h</div>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//</span>
<a name="l00002"></a>00002 <span class="comment">//  SUUpdater.h</span>
<a name="l00003"></a>00003 <span class="comment">//  Sparkle</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">//  Created by Andy Matuschak on 1/4/06.</span>
<a name="l00006"></a>00006 <span class="comment">//  Copyright 2006 Andy Matuschak. All rights reserved.</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#ifndef SUUPDATER_H</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span><span class="preprocessor">#define SUUPDATER_H</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span>
<a name="l00012"></a>00012 <span class="preprocessor">#import &lt;Sparkle/SUVersionComparisonProtocol.h&gt;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="keyword">@class</span> SUUpdateDriver, <a class="code" href="interface_s_u_appcast_item.html">SUAppcastItem</a>, SUHost, <a class="code" href="interface_s_u_appcast.html">SUAppcast</a>;
<a name="l00015"></a><a class="code" href="interface_s_u_updater.html">00015</a> <span class="keyword">@interface </span><a class="code" href="interface_s_u_updater.html">SUUpdater</a> : <a class="code" href="class_n_s_object.html">NSObject</a> {
<a name="l00016"></a>00016         NSTimer *checkTimer;
<a name="l00017"></a>00017         SUUpdateDriver *driver;
<a name="l00018"></a>00018         
<a name="l00019"></a>00019         SUHost *host;
<a name="l00020"></a>00020         IBOutlet <span class="keywordtype">id</span> delegate;
<a name="l00021"></a>00021 }
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 + (<a class="code" href="interface_s_u_updater.html">SUUpdater</a> *)sharedUpdater;
<a name="l00024"></a>00024 + (<a class="code" href="interface_s_u_updater.html">SUUpdater</a> *)updaterForBundle:(NSBundle *)bundle;
<a name="l00025"></a>00025 - (NSBundle *)hostBundle;
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 - (void)setDelegate:(<span class="keywordtype">id</span>)delegate;
<a name="l00028"></a>00028 - delegate;
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 - (void)setAutomaticallyChecksForUpdates:(BOOL)automaticallyChecks;
<a name="l00031"></a>00031 - (BOOL)automaticallyChecksForUpdates;
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 - (void)setUpdateCheckInterval:(NSTimeInterval)interval;
<a name="l00034"></a>00034 - (NSTimeInterval)updateCheckInterval;
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 - (void)setFeedURL:(NSURL *)feedURL;
<a name="l00037"></a>00037 - (NSURL *)feedURL;
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 - (void)setSendsSystemProfile:(BOOL)sendsSystemProfile;
<a name="l00040"></a>00040 - (BOOL)sendsSystemProfile;
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 - (void)setAutomaticallyDownloadsUpdates:(BOOL)automaticallyDownloadsUpdates;
<a name="l00043"></a>00043 - (BOOL)automaticallyDownloadsUpdates;
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="comment">// This IBAction is meant for a main menu item. Hook up any menu item to this action,</span>
<a name="l00046"></a>00046 <span class="comment">// and Sparkle will check for updates and report back its findings verbosely.</span>
<a name="l00047"></a>00047 - (IBAction)checkForUpdates:sender;
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="comment">// This kicks off an update meant to be programmatically initiated. That is, it will display no UI unless it actually finds an update,</span>
<a name="l00050"></a>00050 <span class="comment">// in which case it proceeds as usual. If the fully automated updating is turned on, however, this will invoke that behavior, and if an</span>
<a name="l00051"></a>00051 <span class="comment">// update is found, it will be downloaded and prepped for installation.</span>
<a name="l00052"></a>00052 - (void)checkForUpdatesInBackground;
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="comment">// Date of last update check. Returns null if no check has been performed.</span>
<a name="l00055"></a>00055 - (NSDate*)lastUpdateCheckDate;
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">// This begins a &quot;probing&quot; check for updates which will not actually offer to update to that version. The delegate methods, though,</span>
<a name="l00058"></a>00058 <span class="comment">// (up to updater:didFindValidUpdate: and updaterDidNotFindUpdate:), are called, so you can use that information in your UI.</span>
<a name="l00059"></a>00059 - (void)checkForUpdateInformation;
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="comment">// Call this to appropriately schedule or cancel the update checking timer according to the preferences for time interval and automatic checks. This call does not change the date of the next check, but only the internal NSTimer.</span>
<a name="l00062"></a>00062 - (void)resetUpdateCycle;
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 - (BOOL)updateInProgress;
<a name="l00065"></a>00065 <span class="keyword">@end</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="keyword">@interface </span><a class="code" href="class_n_s_object.html">NSObject</a> (SUUpdaterDelegateInformalProtocol)
<a name="l00068"></a>00068 <span class="comment">// This method allows you to add extra parameters to the appcast URL, potentially based on whether or not Sparkle will also be sending along the system profile. This method should return an array of dictionaries with keys: &quot;key&quot;, &quot;value&quot;, &quot;displayKey&quot;, &quot;displayValue&quot;, the latter two being specifically for display to the user.</span>
<a name="l00069"></a>00069 - (NSArray *)feedParametersForUpdater:(<a class="code" href="interface_s_u_updater.html">SUUpdater</a> *)updater sendingSystemProfile:(BOOL)sendingProfile;
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="comment">// Use this to override the default behavior for Sparkle prompting the user about automatic update checks.</span>
<a name="l00072"></a>00072 - (BOOL)updaterShouldPromptForPermissionToCheckForUpdates:(<a class="code" href="interface_s_u_updater.html">SUUpdater</a> *)bundle;
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="comment">// Implement this if you want to do some special handling with the appcast once it finishes loading.</span>
<a name="l00075"></a>00075 - (void)updater:(<a class="code" href="interface_s_u_updater.html">SUUpdater</a> *)updater didFinishLoadingAppcast:(<a class="code" href="interface_s_u_appcast.html">SUAppcast</a> *)appcast;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="comment">// If you&#39;re using special logic or extensions in your appcast, implement this to use your own logic for finding</span>
<a name="l00078"></a>00078 <span class="comment">// a valid update, if any, in the given appcast.</span>
<a name="l00079"></a>00079 - (<a class="code" href="interface_s_u_appcast_item.html">SUAppcastItem</a> *)bestValidUpdateInAppcast:(<a class="code" href="interface_s_u_appcast.html">SUAppcast</a> *)appcast forUpdater:(<a class="code" href="interface_s_u_updater.html">SUUpdater</a> *)bundle;
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="comment">// Sent when a valid update is found by the update driver.</span>
<a name="l00082"></a>00082 - (void)updater:(<a class="code" href="interface_s_u_updater.html">SUUpdater</a> *)updater didFindValidUpdate:(<a class="code" href="interface_s_u_appcast_item.html">SUAppcastItem</a> *)update;
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="comment">// Sent when a valid update is not found.</span>
<a name="l00085"></a>00085 - (void)updaterDidNotFindUpdate:(<a class="code" href="interface_s_u_updater.html">SUUpdater</a> *)update;
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="comment">// Sent immediately before installing the specified update.</span>
<a name="l00088"></a>00088 - (void)updater:(<a class="code" href="interface_s_u_updater.html">SUUpdater</a> *)updater willInstallUpdate:(<a class="code" href="interface_s_u_appcast_item.html">SUAppcastItem</a> *)update;
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <span class="comment">// Return YES to delay the relaunch until you do some processing; invoke the given NSInvocation to continue.</span>
<a name="l00091"></a>00091 - (BOOL)updater:(<a class="code" href="interface_s_u_updater.html">SUUpdater</a> *)updater shouldPostponeRelaunchForUpdate:(<a class="code" href="interface_s_u_appcast_item.html">SUAppcastItem</a> *)update untilInvoking:(NSInvocation *)invocation;
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 <span class="comment">// Called immediately before relaunching.</span>
<a name="l00094"></a>00094 - (void)updaterWillRelaunchApplication:(<a class="code" href="interface_s_u_updater.html">SUUpdater</a> *)updater;
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 <span class="comment">// This method allows you to provide a custom version comparator.</span>
<a name="l00097"></a>00097 <span class="comment">// If you don&#39;t implement this method or return nil, the standard version comparator will be used.</span>
<a name="l00098"></a>00098 - (<span class="keywordtype">id</span> &lt;<a class="code" href="protocol_s_u_version_comparison-p.html">SUVersionComparison</a>&gt;)versionComparatorForUpdater:(<a class="code" href="interface_s_u_updater.html">SUUpdater</a> *)updater;
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 <span class="comment">// Returns the path which is used to relaunch the client after the update is installed. By default, the path of the host bundle.</span>
<a name="l00101"></a>00101 - (NSString *)pathToRelaunchForUpdater:(<a class="code" href="interface_s_u_updater.html">SUUpdater</a> *)updater;
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 <span class="keyword">@end</span>
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="comment">// Define some minimum intervals to avoid DOS-like checking attacks. These are in seconds.</span>
<a name="l00106"></a>00106 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00107"></a>00107 <span class="preprocessor"></span><span class="preprocessor">#define SU_MIN_CHECK_INTERVAL 60</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00109"></a>00109 <span class="preprocessor"></span><span class="preprocessor">#define SU_MIN_CHECK_INTERVAL 60*60</span>
<a name="l00110"></a>00110 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00111"></a>00111 <span class="preprocessor"></span>
<a name="l00112"></a>00112 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00113"></a>00113 <span class="preprocessor"></span><span class="preprocessor">#define SU_DEFAULT_CHECK_INTERVAL 60</span>
<a name="l00114"></a>00114 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00115"></a>00115 <span class="preprocessor"></span><span class="preprocessor">#define SU_DEFAULT_CHECK_INTERVAL 60*60*24</span>
<a name="l00116"></a>00116 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00117"></a>00117 <span class="preprocessor"></span>
<a name="l00118"></a>00118 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Tue Apr 5 2011 13:29:32 for AppTrap by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
